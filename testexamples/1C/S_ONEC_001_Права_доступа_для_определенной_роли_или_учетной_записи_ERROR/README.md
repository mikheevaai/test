## Описание проверки
**Релиз:**
**ID:** S_ONEC_001
**Язык:** 1С
**Критичность:** ERROR
**Категория:** 

### Название 
Права доступа для определенной роли или учетной записи
### Описание 
Проверка «Права доступа для определенной роли/учетной записи» выявляет случаи использования в программном коде системы «1С:Предприятие» метода программного контроля прав доступа «ПравоДоступа» (AccessRight) для определенной роли/учетной записи. Данный метод позволяет выполнять проверку прав доступа несколькими способами. Небезопасным способом является проверка прав доступа в контексте произвольного пользователя. Вызов метода требует административных прав, если явно указан параметр (роль/учетная запись), для которого проверяются права доступа.

### Угрозы 
- Обход системы авторизации.
### Рекоммендации 
- Удалите из кода небезопасную проверку прав доступа или проанализируйте и обоснуйте корректность её использования.
### Пример 
``` 
Функция СортироватьМассивПользователейИБПередВыгрузкой(Знач ИсходныйМассив)
	ТЗ = Новый ТаблицаЗначений();
	ТЗ.Колонки.Добавить(
		"Пользователь",
		Новый ОписаниеТипов("ПользовательИнформационнойБазы"));
	ТЗ.Колонки.Добавить("Администратор", Новый ОписаниеТипов("Булево"));

	Для Каждого ПользовательИБ Из ИсходныйМассив Цикл
		СтрокаТЗ = ТЗ.Добавить();
		СтрокаТЗ.Пользователь = ПользовательИБ;
		СтрокаТЗ.Администратор = ПравоДоступа(
			"АдминистрированиеДанных", Метаданные, СтрокаТЗ.Пользователь);
	КонецЦикла;

	ТЗ.Сортировать("Администратор Убыв");
	Возврат ТЗ.ВыгрузитьКолонку("Пользователь");
КонецФункции
``` 
### Ссылки
- [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:H/RC:C/CR:H/IR:H/AR:H = 9.9](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:H/RC:C/CR:H/IR:H/AR:H)
- [OWASP TOP-10 A01_2021](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)
- [MITRE CWE-276](https://cwe.mitre.org/data/definitions/276.html)
- [MITRE CWE 280](https://cwe.mitre.org/data/definitions/280.html)
- [MITRE CWE-566](https://cwe.mitre.org/data/definitions/566.html)
- [MITRE CWE-639](https://cwe.mitre.org/data/definitions/639.html)
- [MITRE CWE-863](https://cwe.mitre.org/data/definitions/863.html)

---
## Примечание
