## Описание проверки
**Релиз:**
**ID:** S_ONEC_030
**Язык:** 1С
**Критичность:** ERROR
**Категория:** 

### Название 
Использование методов объекта WScript.Shell и Shell.Application компоненты Windows Script Host операционной системы
### Описание 
Проверка «Использование объекта WScript.Shell и Shell.Application» выявляет наличие в программном коде системы «1С:Предприятие» случаев использования объектов WScript.ShellShell.Application компоненты Windows Script Host операционной системы. Данный объект позволяет запускать новый процесс, создавать ярлыки, работать с системным реестром, получать доступ к переменным среды и специальным папкам операционной системы, запустить приложение, в том числе с использованием параметров.

### Угрозы 
- Взлом операционной системы;
- Установка вредоносных программ;
- Создание привилегированных учетных записей пользователей;
- Доступ на чтение/запись ко всем файлам.
### Рекоммендации 
- Минимизируйте использование компоненты Windows Script Host операционной системы в программном коде системы «1С:Предприятие». В случае отсутствия такой возможности, внимательно проанализируйте код, в контексте которого используются компоненты Windows Script Host операционной системы. Особое внимание уделите контексту использования метода: на клиенте метод будет вызван с правами локального пользователя, а на сервере с правами пользователя, от имени которого запущен сервер 1С:Предприятия.
### Пример 
``` 
Функция ПроверитьСпособДоставки(Рассылка, Знач ПараметрыДоставки) Экспорт
	УстановитьПривилегированныйРежим(Истина);
	ПараметрыЖурнала = Новый Структура;
	ПараметрыЖурнала.Вставить("Данные", Рассылка);

	Процесс = WshShell.Exec("C:\\Progra~1\\Window~1\\Access~1\\wordpad.exe");
	Рез = WshShell.AppActivate(Процесс.ProcessID);
	ПараметрыЖурнала.Вставить("Метаданные", Метаданные.Справочники.РассылкиОтчетов);

	Попытка ShellApplication = Новый COMОбъект("Shell.Application");
		ShellApplication.SetTime();
	Исключение КонецПопытки;
	УстановитьПривилегированныйРежим(Ложь);
КонецФункции
``` 
### Ссылки
- [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:H/RC:C = 10](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:H/RC:C)
- [OWASP TOP-10 A1_2017](https://owasp.org/www-project-top-ten/2017/A1_2017-Injection)
- [MITRE CWE-78](https://cwe.mitre.org/data/definitions/78.html)
- [MITRE CWE-114](https://cwe.mitre.org/data/definitions/114.html)
- [MITRE CWE-284](https://cwe.mitre.org/data/definitions/284.html)
- [MITRE CWE-494](https://cwe.mitre.org/data/definitions/494.html)
- [MITRE CWE-732](https://cwe.mitre.org/data/definitions/732.html)

---
## Примечание
