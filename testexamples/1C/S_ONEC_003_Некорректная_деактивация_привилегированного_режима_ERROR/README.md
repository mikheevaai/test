## Описание проверки
**Релиз:**
**ID:** S_ONEC_003
**Язык:** 1С
**Критичность:** ERROR
**Категория:** 

### Название 
Некорректная деактивация привилегированного режима
### Описание 
• Проверка «Некорректная деактивация привилегированного режима» выявляет случаи некорректного отключения в программном коде системы «1С:Предприятие» привилегированного режима 1С.
В привилегированном режиме не выполняются никакие проверки прав и разрешены любые операции. При отсутствии явного выключения привилегированного режима возникает риск непредусмотренного выполнения потенциально опасных для системы операций.

### Угрозы 
- Обход системы авторизации;
- Выполнение бизнес-логики от имени пользователя в привилегированном режиме.
### Рекоммендации 
- Убедитесь, что привилегированный режим 1С отключен, или проанализируйте и обоснуйте корректность его использования.
- Для выключения привилегированного режима необходимо внутри процедуры или функции, в которой он был включен, вызвать метод «УстановитьПривилегированныйРежим» с параметром «Ложь» столько же раз, сколько раз в этой же процедуре или функции был вызван метод с параметром «Истина».
### Пример 
``` 
Функция ПроверитьСпособДоставки(Рассылка, Знач ПараметрыДоставки)
	УстановитьПривилегированныйРежим(Истина);
	ПараметрыЖурнала = Новый Структура;
	ПараметрыЖурнала.Вставить("Метаданные", Метаданные.Справочники.РассылкиОтчетов);
	ПараметрыЖурнала.Вставить("МассивОшибок", Новый Массив);
	
	ОпаснаяФункция();
КонецФункции
``` 
### Ссылки
- [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:H/RC:C/CR:H/IR:H/AR:H = 9.9](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:H/RC:C/CR:H/IR:H/AR:H)
- [OWASP TOP-10 A1_2017](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)
- [MITRE CWE-277](https://cwe.mitre.org/data/definitions/277.html)
- [MITRE CWE-283](https://cwe.mitre.org/data/definitions/283.html)
- [MITRE CWE-286](https://cwe.mitre.org/data/definitions/286.html)
- [MITRE CWE-732](https://cwe.mitre.org/data/definitions/732.html)
- [SecurityLab](https://www.securitylab.ru/contest/262359.php)

---
## Примечание
